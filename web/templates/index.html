<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Packet Sniffer Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</head>
<body>
    <h1>Configure and Start Packet Sniffer</h1>
    <form id="startCaptureForm" action="/start_sniffer" method="post">
        <label for="interface">Select Interface:</label>
        <select name="interface" id="interface">
            {% for interface in interfaces %}
                <option value="{{ interface.name }}">{{ interface.name }} ({{ interface.ip }})</option>
            {% endfor %}
        </select><br><br>

        <label for="timeout">Timeout (seconds):</label>
        <input type="number" id="timeout" name="timeout" value="300"><br><br>

        <label for="verbose">Verbose:</label>
        <input type="checkbox" id="verbose" name="verbose"><br><br>

        <!-- Input for selecting a file location -->
        <label for="capture_file">Enter File Name to Save Packets (with extension):</label>
        <input type="text" id="capture_file" name="capture_file" placeholder="e.g., capture.csv"><br><br>

        <!-- Download Button (Initially hidden) -->
        <div id="downloadContainer" style="display: none;">
            <h3>Download Capture File:</h3>
            <a href="/download_capture" class="button" id="downloadButton">Download File</a>
        </div>

        <input type="submit" id="startCaptureButton" value="Start Sniffer">
    </form>

    <form action="/stop_sniffer" method="post">
        <input type="submit" value="Stop Sniffer">
    </form>

    <h2>Sniffer Statistics</h2>
    <div id="statistics">
        <!-- Statistics will be populated by JavaScript -->
    </div>

        <!-- Alerts Section -->
    <div id="alertsSection">
        <!-- DNS Tunneling Alerts -->
        <div class="alert-category">
            <span id="dnsTunnelingFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">DNS Tunneling Alerts (<span id="dnsTunnelingCount">0</span>)</span>
            <ul id="dnsTunnelingAlerts" class="alert-list"></ul>
        </div>

        <!-- Brute Force Alerts -->
        <div class="alert-category">
            <span id="bruteForceFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">Brute Force Alerts (<span id="bruteForceCount">0</span>)</span>
            <ul id="bruteForceAlerts" class="alert-list"></ul>
        </div>

        <!-- DDoS Alerts -->
        <div class="alert-category">
            <span id="ddosFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">DDoS Alerts (<span id="ddosCount">0</span>)</span>
            <ul id="ddosAlerts" class="alert-list"></ul>
        </div>

        <!-- Port Scan Alerts -->
        <div class="alert-category">
            <span id="portScanFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">Port Scan Alerts (<span id="portScanCount">0</span>)</span>
            <ul id="portScanAlerts" class="alert-list"></ul>
        </div>

        <!-- Spoofing Alerts -->
        <div class="alert-category">
            <span id="spoofingFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">Spoofing Alerts (<span id="spoofingCount">0</span>)</span>
            <ul id="spoofingAlerts" class="alert-list"></ul>
        </div>

        <!-- Password Exfiltration Alerts -->
        <div class="alert-category">
            <span id="passwordExfiltrationFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">Password Exfiltration Alerts (<span id="passwordExfiltrationCount">0</span>)</span>
            <ul id="passwordExfiltrationAlerts" class="alert-list"></ul>
        </div>

        <!-- SYN Flood Alerts -->
        <div class="alert-category">
            <span id="synfloodFlag" class="alert-flag hidden">
                <i class="fas fa-flag" style="color: red;"></i>
            </span>
            <span class="alert-title">SYN Flood Alerts (<span id="synfloodCount">0</span>)</span>
            <ul id="synfloodAlerts" class="alert-list"></ul>
        </div>

        <!-- Total Alerts -->
        <div class="total-alerts">Total Alerts: <span id="totalAlertCount">0</span></div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="alertDetails"></div>
        </div>
    </div>


        
    </div>

    <h2>Flow Statistics</h2>


    <!-- Flow Statistics Table -->
    <div id="flowStatisticsTableContainer">
        <table id="flowStatisticsTable" class="display">
            <thead>
                <tr>
                    <th>Flow</th>
                    <th>Throughput (B/s)</th>
                    <th>Packet Delay (ms)</th>
                    <th>Jitter (ms)</th>
                    <th>Packet Loss (%)</th>
                    <th>RTT (ms)</th>
                    <th>TTL</th>
                    <th>Bandwidth Utilization (%)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Flow stats will be dynamically populated here -->
            </tbody>
        </table>
    </div>

    <h1>Live Packet Capture</h1>
 
    <div id="tableContainer">
        <table id="packetTable" class ="display">
            <thead>
                <tr>
                    <th>Source IP</th>
                    <th>Destination IP</th>
                    <th>Source MAC</th>
                    <th>Destination MAC</th>
                    <th>IP Version</th>
                    <th>TTL</th>
                    <th>Checksum</th>
                    <th>Packet Size</th>
                    <th>Passing Time</th>
                    <th>Protocol</th>
                    <th>Identifier</th>
                    <th>Sequence</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

        <!-- Modal for Packet Details -->
    <div id="packetModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="packetDetails">
                <!-- Detailed packet information will be displayed here -->
            </div>
        </div>
    </div>
</body>
</html>
