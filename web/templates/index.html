<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Packet Sniffer Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</head>
<body>
    <h1>Configure and Start Packet Sniffer</h1>
    <form id="startCaptureForm" action="/start_sniffer" method="post">
        <label for="interface">Select Interface:</label>
        <select name="interface" id="interface">
            {% for interface in interfaces %}
                <option value="{{ interface.name }}">{{ interface.name }} ({{ interface.ip }})</option>
            {% endfor %}
        </select><br><br>

        <label for="timeout">Timeout (seconds):</label>
        <input type="number" id="timeout" name="timeout" value="300"><br><br>

        <label for="verbose">Verbose:</label>
        <input type="checkbox" id="verbose" name="verbose"><br><br>

        <!-- Input for selecting a file location -->
        <label for="capture_file">Select a File to Save Packets:</label>
        <input type="file" id="capture_file" name="capture_file" webkitdirectory directory mozdirectory placeholder="Optional"><br><br>
        <!-- Download Button (Initially hidden) -->
        <div id="downloadContainer" style="display: none;">
            <h3>Download Capture File:</h3>
            <a href="/download_capture" class="button" id="downloadButton">Download File</a>
        </div>

        <input type="submit" id="startCaptureButton" value="Start Sniffer">
    </form>

    <form action="/stop_sniffer" method="post">
        <input type="submit" value="Stop Sniffer">
    </form>

    <h2>Sniffer Statistics</h2>
    <div id="statistics">
        <!-- Statistics will be populated by JavaScript -->
    </div>

    <h2>Detector Alerts</h2>
        <div id="alertsContainer" class="alerts-container">
            <!-- DNS Tunneling Alert -->
            <div id="dnsTunnelingAlertBox" class="alert-box">
                <h3>DNS Tunneling Alerts</h3>
                <ul id="dnsTunnelingAlerts"></ul>
                <span id="dnsTunnelingFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        
            <!-- Brute Force Alert -->
            <div id="bruteForceAlertBox" class="alert-box">
                <h3>Brute Force Alerts</h3>
                <ul id="bruteForceAlerts"></ul>
                <span id="bruteForceFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        
            <!-- DDoS Alert -->
            <div id="ddosAlertBox" class="alert-box">
                <h3>DDoS Alerts</h3>
                <ul id="ddosAlerts"></ul>
                <span id="ddosFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        
            <!-- Port Scan Alert -->
            <div id="portScanAlertBox" class="alert-box">
                <h3>Port Scan Alerts</h3>
                <ul id="portScanAlerts"></ul>
                <span id="portScanFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        
            <!-- Spoofing Alert -->
            <div id="spoofingAlertBox" class="alert-box">
                <h3>Spoofing Alerts</h3>
                <ul id="spoofingAlerts"></ul>
                <span id="spoofingFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        
            <!-- Password Exfiltration Alert -->
            <div id="passwordExfiltrationAlertBox" class="alert-box">
                <h3>Password Exfiltration Alerts</h3>
                <ul id="passwordExfiltrationAlerts"></ul>
                <span id="passwordExfiltrationFlag" class="flag hidden">&#x1F6A8;</span> <!-- Red Flag Icon -->
            </div>
        </div>
    

        
        <!-- Modal for alert details -->
        <div id="alertModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="alertDetails">
                    <!-- Detailed alert information will be displayed here -->
                </div>
            </div>
        </div>
        
    </div>

    <h2>Flow Statistics</h2>


    <!-- Flow Statistics Table -->
    <div id="flowStatisticsTableContainer">
        <table id="flowStatisticsTable" class="display">
            <thead>
                <tr>
                    <th>Flow</th>
                    <th>Throughput (B/s)</th>
                    <th>Packet Delay (ms)</th>
                    <th>Jitter (ms)</th>
                    <th>Packet Loss (%)</th>
                    <th>RTT (ms)</th>
                    <th>TTL</th>
                    <th>Bandwidth Utilization (%)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Flow stats will be dynamically populated here -->
            </tbody>
        </table>
    </div>

    <h1>Live Packet Capture</h1>
 
    <div id="tableContainer">
        <table id="packetTable" class ="display">
            <thead>
                <tr>
                    <th>Source IP</th>
                    <th>Destination IP</th>
                    <th>Source MAC</th>
                    <th>Destination MAC</th>
                    <th>IP Version</th>
                    <th>TTL</th>
                    <th>Checksum</th>
                    <th>Packet Size</th>
                    <th>Passing Time</th>
                    <th>Protocol</th>
                    <th>Identifier</th>
                    <th>Sequence</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

        <!-- Modal for Packet Details -->
    <div id="packetModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="packetDetails">
                <!-- Detailed packet information will be displayed here -->
            </div>
        </div>
    </div>
</body>
</html>
